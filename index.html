<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UCAS ‚Äì Applicant Review Dashboard</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet" />

  <style>
    :root{
      --ucas-blue:#004aad; --ucas-green:#007b8a;
      --ucas-light:#f4f8fb; --ucas-gray:#e9eef5; 
      --text:#1f2d3d;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    html{scroll-behavior:smooth; scroll-padding-top:110px}
    body{
      font-family:"Inter","Cairo",sans-serif;
      background:
        radial-gradient(60rem 60rem at -10% -10%, rgba(0,122,139,0.25), transparent 60%),
        radial-gradient(60rem 60rem at 110% 10%, rgba(0,74,173,0.25), transparent 60%),
        linear-gradient(135deg,var(--ucas-green),var(--ucas-blue));
      background-attachment: fixed;
      color:var(--text);
    }

    /* NAVBAR */
    nav{
      position:sticky;top:0;z-index:999;
      background:rgba(255,255,255,0.9);
      backdrop-filter:blur(12px);
      border-bottom:1px solid #d5dce6;
    }
    .nav-inner{max-width:1200px;margin:auto;padding:14px;
      display:flex;align-items:center;gap:18px}

    .brand{display:flex;align-items:center;gap:14px}
    .brand img{height:60px;border-radius:14px;padding:6px;background:white}

    .title .main{color:var(--ucas-green);font-weight:800;font-size:1.25rem}
    .title .sub{color:var(--ucas-blue);font-weight:700;font-size:.95rem}

    .links{margin-left:auto;display:flex;gap:18px}
    .links a{
      text-decoration:none;color:var(--ucas-blue);
      font-weight:700;padding:6px 10px;border-radius:10px;
      transition:.25s;
    }
    .links a:hover{background:var(--ucas-light)}

    .lang-btn{
      background:linear-gradient(90deg,var(--ucas-green),var(--ucas-blue));
      color:white;padding:8px 14px;border:none;
      border-radius:12px;font-weight:700;cursor:pointer;
    }

    /* HERO */
    .hero{max-width:1200px;margin:25px auto;padding:0 16px}
    .hero-inner{
      background:white;border-radius:18px;padding:28px;
      display:grid;grid-template-columns:1.2fr .8fr;gap:28px;
      border:1px solid #dce5ef;
      box-shadow:0 14px 40px rgba(0,0,0,.12);
    }
    .hero h1{color:var(--ucas-blue);font-size:2.2rem;margin-bottom:.5rem}
    .hero p{color:#475569;margin-bottom:1.2rem}

    .cta{display:flex;gap:14px;flex-wrap:wrap}
    .btn{
      padding:12px 18px;border-radius:12px;border:none;cursor:pointer;
      font-weight:800;color:white;
      background:linear-gradient(90deg,var(--ucas-green),var(--ucas-blue));
    }
    .btn.secondary{
      background:white;color:var(--ucas-blue);
      border:2px solid var(--ucas-blue)
    }

    .hero-card{
      background:#ffffff;border-radius:18px;
      padding:14px;
      display:grid;grid-template-columns:repeat(3,1fr);
      gap:14px;border:1px solid #dce6f0;
    }

    .mini{background:var(--ucas-light);border-radius:10px;padding:12px;
      border-left:6px solid var(--ucas-green)}
    .mini b{color:var(--ucas-blue)}
    /* UNIVERSAL CARD SECTIONS */
    main{max-width:1200px;margin:22px auto;padding:0 16px}
    .section{
      background:white;border-radius:16px;
      padding:20px;margin-bottom:22px;
      border:1px solid #dce4ef;
      box-shadow:0 10px 25px rgba(0,0,0,.10)
    }
    .section h3{
      color:var(--ucas-blue);
      border-bottom:2px solid var(--ucas-green);
      display:inline-block;padding-bottom:4px;margin-top:0;
      font-size:1.35rem;font-weight:800;
    }

    textarea{width:100%;padding:14px;font-size:1rem;
      border:1px solid #ced8e4;border-radius:12px}

    .controls{display:flex;gap:12px;margin-bottom:12px;flex-wrap:wrap}

    /* üî• Applicants animated cards */
    .grid-cards{
      display:grid;gap:18px;margin-top:14px;
      grid-template-columns:repeat(auto-fill,minmax(290px,1fr));
    }
    .app-card{
      background:white;padding:18px;border-radius:16px;
      border:1px solid #e2e8f0;
      box-shadow:0 8px 24px rgba(0,0,0,.06);
      opacity:0;transform:translateY(20px);
      transition:all .6s ease;
    }
    .app-card.visible{opacity:1;transform:translateY(0)}
    .app-card .name{color:var(--ucas-blue);font-size:1.2rem;font-weight:800}
    .app-card .meta{color:#475569;font-size:.9rem;margin-bottom:8px}
    .app-card .score{
      background:linear-gradient(135deg,var(--ucas-green),var(--ucas-blue));
      font-weight:800;color:white;
      width:48px;height:48px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      font-size:1rem;
    }
    .app-card .row{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .app-card .actions{display:flex;gap:10px;margin-top:10px}
    .app-card .btn-mini{
      padding:6px 10px;border-radius:10px;font-weight:700;
      background:white;border:1px solid var(--ucas-blue);
      color:var(--ucas-blue);cursor:pointer;
    }

    footer{color:#eaf2fb;text-align:center;padding:28px}
  </style>
</head>

<body>

<!-- NAVBAR -->
<nav>
  <div class="nav-inner">
    
    <div class="brand">
      <img src="https://i.postimg.cc/9MznzvS9/239749074-4090792351043901-7140990477766433582-n-jpg-nc-cat-106-ccb-1-7-nc-sid-6ee11a-nc-ohc-pi-Ld.jpg">
      <div class="title">
        <div class="main" data-i18n="collegeName">University College of Applied Sciences (UCAS)</div>
        <div class="sub" data-i18n="facultyName">Faculty of Engineering & Smart Systems</div>
      </div>
    </div>

    <div class="links">
      <a href="#home" data-i18n="navHome">Home</a>
      <a href="#jobdesc" data-i18n="navJobDesc">Job Description</a>
      <a href="#applicants" data-i18n="navApplicants">Applicants</a>
      <a href="#shortlist" data-i18n="navShortlist">Shortlist</a>
      <a href="#contact" data-i18n="navContact">Contact</a>
      <button class="lang-btn" id="langToggle">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
    </div>
  </div>
</nav>

<!-- HERO -->
<section class="hero" id="home">
  <div class="hero-inner">
    <div>
      <h1 data-i18n="heroTitle">Applicant Review Dashboard</h1>
      <p data-i18n="heroSubtitle">
        An elegant, data-driven interface to review, evaluate, and shortlist candidates.
      </p>

      <div class="cta">
        <a href="#applicants" class="btn" data-i18n="ctaStart">Start Reviewing</a>
        <a href="#jobdesc" class="btn secondary" data-i18n="ctaUpdateProfile">Update Job Description</a>
      </div>
    </div>

    <div class="hero-card">
      <div class="mini"><b data-i18n="kpi1Title">Live Data</b><div data-i18n="kpi1Text" class="muted">Synced from Google Sheets</div></div>
      <div class="mini"><b data-i18n="kpi2Title">AI Scoring</b><div data-i18n="kpi2Text" class="muted">Automated profile matching</div></div>
      <div class="mini"><b data-i18n="kpi3Title">Export</b><div data-i18n="kpi3Text" class="muted">One-click CSV</div></div>
    </div>
  </div>
</section>

<main>
<!-- JOB DESCRIPTION -->
<section class="section" id="jobdesc">
  <h3 data-i18n="jobDescTitle">üìù Job Description</h3>
  <p class="muted" data-i18n="jobDescHint">
    Enter or paste the role profile in English and click Save to sync with the workflow.
  </p>

  <textarea id="jobDescInput" rows="6"></textarea>

  <div class="row-actions">
    <span id="saveStatus" class="muted"></span>
    <button class="btn" id="saveJobDesc" data-i18n="save">Save</button>
  </div>
</section>

<!-- APPLICANTS -->
<section class="section" id="applicants">
  <h3 data-i18n="applicantsTitle">üë§ Applicants</h3>

  <div class="controls">
    <select id="applicantSelect"><option>Loading‚Ä¶</option></select>
    <button class="btn" id="refreshBtn" data-i18n="refreshBtn">Refresh</button>
    <span class="muted" id="totalApplicants">Loading‚Ä¶</span>
  </div>

  <!-- Detailed applicant cards (original) -->
  <section class="cards" id="cards" style="display:none"></section>

  <!-- NEW: Animated grid cards -->
  <div class="grid-cards" id="applicantCards"></div>
</section>

<!-- SHORTLIST -->
<section class="section" id="shortlist">
  <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
    <h3 id="shortlistTitle">Shortlisted (Score > 7)</h3>
    <div>
      <button class="btn" id="refreshShortlistBtn" data-i18n="refreshShortlist">Refresh shortlist</button>
      <button class="btn" id="exportCSV" data-i18n="exportCSV">Export CSV</button>
    </div>
  </div>

  <input id="searchShortlist" type="text" placeholder="Search...">
  <div id="shortlistContainer" class="muted" style="margin-top:10px;">
    No shortlisted applicants yet.
  </div>
</section>

</main>

<footer id="contact">
  ¬© 2025 UCAS ‚Äì Faculty of Engineering & Smart Systems ¬∑ Programmed by Eng. Eid Elagha
</footer>

<script>
const CSV_URL =
 "https://docs.google.com/spreadsheets/d/e/2PACX-1vQWe3rtqVXI0582iM7jNSSnxSP7dySxe3dkAyzP9dLj13SDlaxSiavyPdtHenAU_waMiHvFjrW8mEUw/pub?output=csv";

const N8N_ENDPOINT =
 "https://n8nprojects2026.app.n8n.cloud/webhook/job_description_update";

const $ = (id)=>document.getElementById(id);
const state = { rows:[], lang:"en" };

/* ------------------- i18n ------------------- */
const t = {
  en:{
    navHome:"Home", navApplicants:"Applicants", navShortlist:"Shortlist",
    navContact:"Contact", navJobDesc:"Job Description",
    collegeName:"University College of Applied Sciences (UCAS)",
    facultyName:"Faculty of Engineering & Smart Systems",
    heroTitle:"Applicant Review Dashboard",
    jobDescTitle:"üìù Job Description",
    jobDescHint:"Enter or paste the role profile in English and click Save."
  },
  ar:{
    navHome:"ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©", navApplicants:"ÿßŸÑŸÖÿ™ŸÇÿØŸÖŸàŸÜ", navShortlist:"ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÇÿµŸäÿ±ÿ©",
    navContact:"ÿ™ŸàÿßÿµŸÑ", navJobDesc:"ŸàÿµŸÅ ÿßŸÑŸàÿ∏ŸäŸÅÿ©",
    collegeName:"ÿßŸÑŸÉŸÑŸäÿ© ÿßŸÑÿ¨ÿßŸÖÿπŸäÿ© ŸÑŸÑÿπŸÑŸàŸÖ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇŸäÿ©",
    facultyName:"ŸÉŸÑŸäÿ© ÿßŸÑŸáŸÜÿØÿ≥ÿ© ŸàÿßŸÑÿ£ŸÜÿ∏ŸÖÿ© ÿßŸÑÿ∞ŸÉŸäÿ©",
    heroTitle:"ŸÑŸàÿ≠ÿ© ÿ™ŸÇŸäŸäŸÖ ÿßŸÑŸÖÿ™ŸÇÿØŸÖŸäŸÜ",
    jobDescTitle:"üìù ŸàÿµŸÅ ÿßŸÑŸàÿ∏ŸäŸÅÿ©",
    jobDescHint:"ÿ£ÿØÿÆŸÑ ÿ£Ÿà ÿ£ŸÑÿµŸÇ ŸàÿµŸÅ ÿßŸÑŸàÿ∏ŸäŸÅÿ© ÿ´ŸÖ ÿßÿ∂ÿ∫ÿ∑ ÿ≠ŸÅÿ∏."
  }
};

function applyI18n(){
  const dict = t[state.lang];
  document.querySelectorAll("[data-i18n]").forEach(el=>{
    el.textContent = dict[el.getAttribute("data-i18n")] || "";
  });
  document.documentElement.dir = state.lang==="ar" ? "rtl" : "ltr";
  $("langToggle").textContent = state.lang==="ar" ? "English" : "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©";
}

/* ------------------- CSV PARSER ------------------- */
function parseCSV(text){
  const lines = text.split(/\r?\n/);
  const headers = lines.shift().split(",");
  return lines.map(line=>{
    const cells = line.split(",");
    return Object.fromEntries(headers.map((h,i)=>[h,cells[i]||""]));
  });
}

/* ------------------- LOAD DATA ------------------- */
async function loadData(){
  const res = await fetch("https://corsproxy.io/?" + encodeURIComponent(CSV_URL));
  const text = await res.text();
  const rows = parseCSV(text);
  state.rows = rows;
  hydrateDropdown(rows);
  renderAllApplicantsCards(rows);
  applyI18n();
  revealOnScroll();
}

/* ------------------- APPLICANT DROPDOWN ------------------- */
function hydrateDropdown(rows){
  const sel = $("applicantSelect");
  sel.innerHTML = "<option>Select applicant</option>";
  rows.forEach(r=>{
    const name = r.NAME || r["Full Name"] || "Unnamed";
    const o=document.createElement("option");
    o.value=name; o.textContent=name;
    sel.appendChild(o);
  });
}

/* ------------------- ANIMATED APPLICANT CARDS ------------------- */
function renderAllApplicantsCards(rows){
  const container = $("applicantCards");
  container.innerHTML = rows.map((r,i)=>{
    const name = r.NAME || r["Full Name"] || "Unnamed";
    const city = r.CITY || "";
    const email = r.EMAIL || "";
    const score = r.VOTE || "-";
    const cv = r["CV LINK"] || "";

    return `
      <div class="app-card reveal" style="transition-delay:${i*30}ms">
        <div class="row">
          <div>
            <div class="name">${name}</div>
            <div class="meta">${city} ¬∑ ${email}</div>
          </div>
          <div class="score">${score}</div>
        </div>
        <div class="actions">
          ${cv?`<button class="btn-mini" onclick="openCV('${cv}')">View CV</button>`:""}
        </div>
      </div>
    `;
  }).join("");
}

/* ------------------- REVEAL ON SCROLL ------------------- */
function revealOnScroll(){
  const cards = document.querySelectorAll(".reveal");
  const io = new IntersectionObserver((entries)=>{
    entries.forEach(e=>{
      if(e.isIntersecting){
        e.target.classList.add("visible");
        io.unobserve(e.target);
      }
    });
  });
  cards.forEach(c=>io.observe(c));
}

/* ------------------- VIEW CV ------------------- */
function openCV(link){
  window.open(link,"_blank");
}

/* ------------------- SAVE JOB DESCRIPTION ------------------- */
$("saveJobDesc").onclick = async ()=>{
  const val = $("jobDescInput").value.trim();
  $("saveStatus").textContent = "Saving‚Ä¶";
  const res = await fetch(N8N_ENDPOINT,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ profile_wanted:val })
  });
  $("saveStatus").textContent = res.ok ? "Saved!" : "Failed!";
};

/* ------------------- LANG TOGGLE ------------------- */
$("langToggle").onclick = ()=>{
  state.lang = state.lang==="en" ? "ar" : "en";
  applyI18n();
};

/* ------------------- INIT ------------------- */
loadData();
</script>

</body>
</html>

